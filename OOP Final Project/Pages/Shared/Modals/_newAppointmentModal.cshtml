<div class="modal fade" id="newAppointmentModal" tabindex="-1" aria-labelledby="newAppointmentModalLabel">
    <div class="modal-dialog modal-dialog-centered" style="max-width: 80%;"> <!-- Custom size for modal -->
        <div class="modal-content" style="border-radius: 16px;">
            <div class="modal-header">
                <h5 class="modal-title" id="newAppointmentModalLabel">New Appointment</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <!-- Left Column (Patient Info) -->
                    <div class="col-md-6 position-relative">
                        <!-- Patient info will be displayed here -->
                        <div class="input-group mb-3">
                            <span class="input-group-text ">Patient</span>
                            <input type="text" class="form-control" id="patientSearch" placeholder="Enter patient info"
                                oninput="searchPatients()" autocomplete="off">
                        </div>
                        <div style="display: flex; justify-content: center;">
                            <!-- The dropdown will be placed here -->
                            <div id="patientDropdown" class="list-group shadow-sm"
                                style="max-height: 200px; overflow-y: auto; display: none; position: absolute; z-index: 1050; width: 90%; ">
                            </div>
                        </div>

                        <!-- Patient Info (Initially Hidden) -->
                        <div id="patientInfo" class="d-flex flex-column gap-md-2">
                            <div class="d-flex" style="align-items: center;">
                                <label for="patientId" class="form-label text-muted mb-0 pe-2 w-25">ID</label>
                                <input class="form-control text-muted " type="text" id="patientId" placeholder="1"
                                    disabled>
                            </div>
                            <div class="d-flex" style="justify-content:flex-start; align-items: center;">
                                <label for="patientName" class="form-label text-muted mb-0 pe-2 w-25    ">Full
                                    Name</label>
                                <input class="w-100 form-control text-muted" type="text" id="patientName"
                                    placeholder="John Doe" disabled>
                            </div>
                            <div class="d-flex" style="align-items: center;">
                                <label for="patientLastVisit" class="form-label text-muted mb-0 w-25">Last Visit</label>
                                <input class="form-control text-muted " type="text" id="patientLastVisit"
                                    placeholder="2023-12-10" disabled>
                            </div>

                            <div class="d-flex" style="align-items: center;">
                                <label for="patientPhone" class="form-label text-muted mb-0 w-25">Phone</label>
                                <input class="form-control text-muted" type="text" id="patientPhone"
                                    placeholder="123-456-7890" disabled>
                            </div>


                            <div class="d-flex flex-column w-100" style="align-items: center;">
                                <label class="form-label text-muted mb-2 ">Lastest diagnose</label>
                                <input class="form-control text-muted" type="text" id="patientPhone"
                                    placeholder="lip sum" disabled>
                            </div>




                        </div>


                    </div>

                    <!-- Right Column (Appointment Info) -->
                    <div class="col-md-6">
                        <div class="mb-3 d-flex">
                            <label for="appointmentDate" class="form-label">Appointment Date</label>
                            <input type="date" class="form-control" id="appointmentDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="appointmentTime" class="form-label">Appointment Time</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" id="appointmentTime1"
                                    name="appointmentTime">
                                <label class="form-check-label" for="appointmentTime1">
                                    7:00 - 8:00 AM
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" disabled id="appointmentTime2"
                                    name="appointmentTime">
                                <label class="form-check-label" for="appointmentTime2">
                                    8:00 - 9:00 AM
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" id="appointmentTime3"
                                    name="appointmentTime">
                                <label class="form-check-label" for="appointmentTime3">
                                    9:00 - 10:00 AM
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="reason" class="form-label">Reason for Visit</label>
                            <textarea class="form-control" id="reason" rows="4"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="saveAppointmentBtn">Save Appointment</button>
            </div>
        </div>
    </div>
</div>


<script>
    // Sample patient data (replace with actual data fetching logic)
    const patients = [
        { id: 1, name: "John Doe", age: 30, gender: "Male", lastVisit: "2023-12-10", phone: "123-456-7890" },
        { id: 2, name: "Jane Smith", age: 25, gender: "Female", lastVisit: "2023-12-05", phone: "987-654-3210" },
        { id: 3, name: "Michael Johnson", age: 40, gender: "Male", lastVisit: "2023-11-20", phone: "456-789-1234" }
    ];

    // Function to search for patients based on the input (search by name, age, gender, or id)
    function searchPatients() {
        const input = document.getElementById('patientSearch').value.trim().toLowerCase();
        const patientDropdown = document.getElementById('patientDropdown');

        // Clear any existing dropdown items
        patientDropdown.innerHTML = "";

        // Clear the previous patient info when the user starts typing a new search
        document.getElementById('patientName').value = '';
        document.getElementById('patientId').value = '';
        document.getElementById('patientLastVisit').value = '';
        document.getElementById('patientPhone').value = '';

        document.getElementById('patientInfo').style.display = 'none'; // Hide previous patient info

        if (input === "") {
            patientDropdown.style.display = "none"; // Hide dropdown if no input
            return;
        }

        // Filter patients based on the search query (name, age, gender, or id)
        const filteredPatients = patients.filter(patient => {
            return patient.name.toLowerCase().includes(input) ||
                patient.age.toString().includes(input) ||
                patient.gender.toLowerCase().includes(input) ||
                patient.id.toString().includes(input); // Search by ID as well
        });

        // If there are matching patients, show the dropdown
        if (filteredPatients.length > 0) {
            patientDropdown.style.display = "block"; // Show dropdown
            filteredPatients.forEach(patient => {
                const patientItem = document.createElement('button');
                patientItem.classList.add('list-group-item', 'list-group-item-action');
                patientItem.textContent = `ID: ${patient.id} - ${patient.name} - ${patient.age} years old, ${patient.gender}`;
                patientItem.onclick = () => selectPatient(patient);
                patientDropdown.appendChild(patientItem);
            });
        } else {
            patientDropdown.style.display = "none"; // Hide dropdown if no matches
        }
    }

    // Function to display selected patient information in input fields
    function selectPatient(patient) {
        // Set input fields with patient info
        document.getElementById('patientSearch').value = patient.name; // Set patient name in the input field
        document.getElementById('patientName').value = patient.name;
        document.getElementById('patientId').value = patient.id;
        document.getElementById('patientLastVisit').value = patient.lastVisit || "N/A";
        document.getElementById('patientPhone').value = patient.phone || "N/A";

        // Show patient info and hide dropdown once a patient is selected
        document.getElementById('patientInfo').style.display = "block";
        document.getElementById('patientDropdown').style.display = "none";
    }
</script>
